#pragma once

#include <xrn/Engine/Camera.hpp>
#include <xrn/Engine/Vulkan/Window.hpp>
#include <xrn/Engine/Component/Position.hpp>
#include <xrn/Engine/Component/Rotation.hpp>

namespace xrn::engine {

///////////////////////////////////////////////////////////////////////////
/// \brief No clue what it does xD
/// \ingroup vulkan
///
/// \include MousePointer.hpp <MousePointer.hpp>
///
///////////////////////////////////////////////////////////////////////////
class MousePointer {

public:

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    // Constructors
    //
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    ///////////////////////////////////////////////////////////////////////////
    ///
    ///////////////////////////////////////////////////////////////////////////
    MousePointer(
        ::xrn::engine::Camera& camera
        , ::xrn::engine::vulkan::Window& window
    );



    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    // Getters/setters
    //
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    ///////////////////////////////////////////////////////////////////////////
    /// \brief Update the mouse ray to detect where is the mouse pointing to
    ///////////////////////////////////////////////////////////////////////////
    void updateRay(
        ::xrn::engine::Camera& camera
    );

    ///////////////////////////////////////////////////////////////////////////
    /// \brief Update the mouse ray to detect where is the mouse pointing to
    ///
    /// Called when cursor position changed
    ///////////////////////////////////////////////////////////////////////////
    void updateRay(
        ::xrn::engine::Camera& camera
        , ::xrn::engine::vulkan::Window& window
    );

    ///////////////////////////////////////////////////////////////////////////
    ///
    ///////////////////////////////////////////////////////////////////////////
    [[ nodiscard ]] auto getRay() const
        -> const ::glm::vec3&;

    ///////////////////////////////////////////////////////////////////////////
    ///
    ///////////////////////////////////////////////////////////////////////////
    [[ nodiscard ]] auto castToPlane(
        const ::xrn::engine::component::Position& cameraPosition
        , const ::glm::vec3& planePosition
        , const ::glm::vec3& planeRotation
    ) const
        -> ::glm::vec3;





private:

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    // Member variables
    //
    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////

    ::glm::vec4 m_normalizedMouseCoordinates;
    ::glm::vec3 m_ray;

};

} // namespace xrn::engine
